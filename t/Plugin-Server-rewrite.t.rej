***************
*** 58,80 ****
  --- input
  <form method="post" action="http://example.com/search"><input type="submit" value="go" /></form>
  --- expected
- <html><form action="http://localhost:9999/http%3A%2F%2Fexample.com%2Fsearch" method="post"><input type="submit" value="go" /></form></html>
  
  === relative
  --- input
  <form method="post" action="/search"><input type="submit" value="go" /></form>
  --- expected
- <html><form action="http://localhost:9999/http%3A%2F%2Frelative.example.jp%2Fsearch" method="post"><input type="submit" value="go" /></form></html>
  
  === relative img
  --- input
  <img src="/foo.jpg" />
  --- expected
- <html><img src="http://localhost:9999/http%3A%2F%2Frelative.example.jp%2Ffoo.jpg" /></html>
  
  === abs img
  --- input
  <img src="http://example.com/bar.jpg">
  --- expected
- <html><img src="http://localhost:9999/http%3A%2F%2Fexample.com%2Fbar.jpg" /></html>
  
--- 58,86 ----
  --- input
  <form method="post" action="http://example.com/search"><input type="submit" value="go" /></form>
  --- expected
+ <html><form action="http://localhost:9999/?moxy_q=http%3A%2F%2Fexample.com%2Fsearch" method="post"><input type="submit" value="go" /></form></html>
  
+ === form with query
+ --- input
+ <form method="post" action="http://example.com/search?k=foo"><input type="submit" value="go" /></form>
+ --- expected
+ <html><form action="http://localhost:9999/?moxy_q=http%3A%2F%2Fexample.com%2Fsearch" method="post"><input type="submit" value="go" /><input name="k" type="hidden" value="foo" /></form></html>
+ 
  === relative
  --- input
  <form method="post" action="/search"><input type="submit" value="go" /></form>
  --- expected
+ <html><form action="http://localhost:9999/?moxy_q=http%3A%2F%2Frelative.example.jp%2Fsearch" method="post"><input type="submit" value="go" /></form></html>
  
  === relative img
  --- input
  <img src="/foo.jpg" />
  --- expected
+ <html><img src="http://localhost:9999/?moxy_q=http%3A%2F%2Frelative.example.jp%2Ffoo.jpg" /></html>
  
  === abs img
  --- input
  <img src="http://example.com/bar.jpg">
  --- expected
+ <html><img src="http://localhost:9999/?moxy_q=http%3A%2F%2Fexample.com%2Fbar.jpg" /></html>
  
